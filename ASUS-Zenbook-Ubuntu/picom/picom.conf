#################################
#      Picom Configuration      #
#      For XMonad on Ubuntu     #
#################################

#################################
# Backend & General Settings
#################################

backend = "glx";                 # Use GLX backend for best performance.
vsync = true;                    # Prevent screen tearing.
use-damage = true;               # Enable damage tracking for better efficiency.
refresh-rate = 0;                # Auto-detect refresh rate.
detect-client-opacity = true;    # Respect app opacity hints.
unredir-if-possible = false;     # Keep compositor always running (better for animations).

#################################
# Transparency / Opacity
#################################

inactive-opacity = 0.90;         # Slightly fade unfocused windows.
active-opacity = 1.00;           # Fully opaque for focused windows.
frame-opacity = 0.90;            # Borders and titlebars (if any).
inactive-opacity-override = false;

# Optional: fade different window types
opacity-rule = [
  "90:class_g = 'XTerm'",
  "95:class_g = 'URxvt'",
  "95:class_g = 'Alacritty'"
];

#################################
# Fading (Enable/Disable)
#################################

fading = true;                   # Enable fading transitions.
fade-delta = 5;                  # Time between fade steps (ms).
fade-in-step = 0.03;             # Opacity increment per frame.
fade-out-step = 0.03;            # Opacity decrement per frame.
no-fading-openclose = false;     # Fade when windows open/close.
no-fading-destroyed-argb = true; # Avoid artifacts on some apps.

#################################
# Animations (Experimental)
#################################

animations = true;                     # Enable animation subsystem.
animation-stiffness = 200.0;           # Higher = snappier motion.
animation-dampening = 20.0;            # Lower = faster movement.
animation-window-mass = 0.5;           # Affects inertia.
animation-clamping = false;            # Allow motion beyond start/end points.

# Animation effects per window type
animation-for-open-window = "zoom";    # Options: none, fly-in, zoom, slide-up, slide-down, slide-left, slide-right.
animation-for-unmap-window = "zoom";
animation-for-transient-window = "slide-up";

animation-for-workspace-switch-in = "slide-right";
animation-for-workspace-switch-out = "slide-left";

#################################
# Corners & Shadows
#################################

corner-radius = 8;               # Rounded corners.
detect-rounded-corners = true;

shadow = true;
shadow-radius = 12;              # Blur radius for shadows.
shadow-offset-x = -8;
shadow-offset-y = -8;
shadow-opacity = 0.35;
shadow-ignore-shaped = false;

# Optional: exclude shadows for certain windows
shadow-exclude = [
  "name = 'Notification'",
  "class_g = 'Conky'",
  "class_g = 'Dunst'",
  "_GTK_FRAME_EXTENTS@:c"
];

#################################
# Blur
#################################

blur-method = "dual_kawase";     # Fast and pretty blur.
blur-strength = 6;
blur-background = true;
blur-background-frame = true;
blur-kern = "3x3box";

#################################
# Window Exclusions
#################################

# Donâ€™t apply effects to these
focus-exclude = [
  "class_g = 'Conky'",
  "class_g = 'Polybar'",
  "class_g = 'xmobar'"
];

#################################
# Logging & Debugging
#################################

log-level = "warn";              # "info" or "debug" for troubleshooting.
use-ewmh-active-win = true;

#################################
# XMonad Integration Notes
#################################
# - Start this via xmonad startup hook:
#     spawnOnce "picom --config ~/.config/picom/picom.conf &"
# - If you experience flickering, set:
#     use-damage = false
# - For Nvidia: use environment variable:
#     export KWIN_TRIPLE_BUFFER=1
# - Avoid setting 'unredir-if-possible = true' (breaks fade effects in tiling WMs)
#################################
